# circular dht

피어는 자신을 중심으로 앞에있는 successor(immediate successor or 자기 바로 다음에 나오는)랑 뒤에있는 predecessor가 있음.

링크드 리스트와 유사함.
네트웤에 피어들이 분산되있어도 하나의 원처럼 보임

p2p네트웤에 n개 피어가 있을때, 필요한 벨류를 얻으려면 O(N)임

굉장히 큰 p2p네트웤이면 O(n)이 너무 느림...

그래서 shortcuts을 활요해서 속도를 높임
피어에 숏컷을 넣음.
숏컷은 어케 알아오나! 다음 애한테 쿼리했을때 답이오면, 나 뿐만 아니라 응답한 놈도 피투피에 있다는걸 암

쿼리를 이전에 했으면 응답을 준 애들을 기억해놓고, 지름길로 활용함
이렇게 되면 logN이 됨

# peer churn

피투피에서 피어가 아무때나 나가고 들어오는 상황
각 피어는 바로 다음 피어랑, 바로 전도 앎.
immediate를 넘어서 next까지도 앎. 다담, 전전!

각 피어는 주기적으로 이미디 애들한테 ping을 보냄
핑을 주면 응답을 받음. 걔 기준 이미티가 누군지 ㅇㅇ
만약 핑의 응답이 없으면 자기 다음 이미디가 빠져 나간 뜻
그러면 넥스트를 이미디로 바꾸면 됨
보통 핑 3번 보내고 응답이 없으면 사라진걸 판단함.

피어천은 보통 앞쪽에 있는 애가 바뀌는지 확인함.

피어가 조인할때!
걔는 피투피에 존재하는 최소 1개이상의 피어정보(well-known peers)를 알아야함.
피투피를 운영하는 운영자가 있음. 걔가 웹페이지에 이걸 공지해놓음.

일단 자신의 아이디를 랜덤하게 갖고, 웰 논 피어로 정보를 하나 갖고옴
그리고 웰논피어에서 이미디 석세서 위치를 파악해서 다음으로 넘기는 과정을 반복함.
그러다 사잇값이 나오면 거기에 연결 ACK을 보냄.
그리고 연결하고 주위값도 다 바꿔줌

# P2P 시스템 and applications

centralized랑 distirbuted로 나뉨

centralized : napster, 소리바다
distributed : kademlia
hybrid : bitTorrent(디스트리뷰티드하면 카뎀리아랑 유사하고 센트럴라이즈하면 일반적으로 사용하는 비트토렌트 형태임)

centralized p2p system
: 서버에 피어들에 대한 정보를 관리하고 실질적인 파일교환은 피어끼리!
: dht는 완전 분산이라 서버없이 피어끼리하는데 이건 아님
: 쿼리를 서버에 물어봄, 자신의 키 벨류를 서버에 저장함
: bit torrent

distributed p2p system
: dht처럼 피어끼리! 서버 도움없이!
: 카뎀리아는 중국 p2p시스템.

피투피는 파일 교환, 커뮤니케이션, 멀티미디어 스트리밍, 멀티플레이 게임, 화이트보드, 병렬텀퓨터 등에 사용됨
놀고있는 컴터들을 피투피로 엮어서 계산을 컴퓨터에 나누고 계산을 모아서 새로 값을 구하는. grid
키 : 연산에 필요한 변수, 벨류 : 그 값을 갖고있는 컴터 아이피

# bit torrent

현재 인터넷은 어디든 Internet(대문자)

1. centralized (이걸 사용함)
   서버를 트래커라고함.
   정보는 토렌트파일로 관리됨.
2. decentralized
   it uses kademlia DHT

### Tracker

    서버

### Seeders

    해당하는 컨텐츠의 전체 모든 피스를 갖는 피어

### Leechers

    일부만 갖는 피어

### Swarm

    특정 파일에 대해 공유하고있는 시더랑 리처 피어의 그룹.
    트래커는 이 swarm을 관리함.

내가 파일을 가져오고 줄떄, 결국 트래커로 접속하는 과정임.
